# 研究報告演講稿 - SAITS增強型SensorLLM用於人體活動識別

## 開場白 (Introduction)
各位老師、同學大家好！今天我要和大家分享一個非常實用的研究成果，這個研究解決了我們日常生活中可能都會遇到的問題。大家想想看，我們每天都戴著智慧手錶或手環，這些設備可以追蹤我們的活動，但是為了省電，它們往往降低了數據採集的頻率。這就產生了一個問題：數據品質下降，識別準確率也跟著降低。

我們的研究就是要解決這個問題 - 如何在低頻率感測器數據上仍然保持高準確率的人體活動識別。

## 大綱介紹 (Outline)
今天的報告我會分成幾個部分：
- 首先介紹研究背景，讓大家了解為什麼這個問題很重要
- 然後回顧相關研究，看看別人是怎麼做的
- 接著說明我們要解決的具體問題
- 展示一些初步觀察結果
- 詳細介紹我們的解決方案
- 最後分享實驗結果和結論

## 研究背景：HAR的重要性 (The Promise of Human Activity Recognition)

好，讓我們從頭開始。首先，什麼是人體活動識別，也就是HAR？

大家可以看看螢幕上的這張圖。這張圖生動地展示了HAR技術能做什麼：從跑步、走路到坐下，我們的穿戴設備能夠自動識別這些活動。這背後的技術，就是HAR。

這項技術的潛力非常巨大，它的應用已經滲透到我們生活的方方面面：
- 在**行動健康**領域，醫生可以透過持續追蹤病人的活動模式，來評估他們的康復進度。
- 在**運動分析**中，教練可以利用它來分析運動員的表現，甚至預防潛在的運動傷害。
- 在**人機互動**方面，我們可以用手勢來控制各種智能設備。
- 最終，在**智慧城市**的藍圖裡，HAR是建構情境感知環境的核心技術之一。

簡單來說，HAR的核心任務就是從感測器數據中，自動辨識出我們每天的各種活動。但要在真實世界中實現這一點，我們還面臨著一個重大的研究挑戰。

## 核心挑戰：電池vs準確率的兩難 (The Critical Challenge: Performance Degradation with Downsampling)

這個挑戰，也是我們研究的核心動機，就是一個非常現實的兩難困境：**電池續航力**與**識別準確率**之間的權衡。

請看螢幕右邊這張圖，它非常直觀地說明了這個問題。為了延長電池壽命，現在市面上的穿戴設備，比如你的智慧手錶，通常會選擇降低感測器的採樣頻率。

但這樣做的代價是什麼？當採樣頻率降低，也就是我們說的**降採樣 (Downsampling)**，會直接導致數據品質的下降。這會帶來一系列的技術問題：
- 首先是**資訊損失**：許多細微的、高頻的動作模式會完全消失。
- 其次是**雜訊增加**：信號的信噪比會變差。
- 最直接的後果是**判別力降低**：很多原本可以區分的相似活動，現在看起來都差不多了。

最終，這些問題會嚴重影響HAR的準確率，這也限制了這項技術在實際場景中的廣泛應用。

## 初步實驗：問題有多嚴重？ (Preliminary Experiment: Downsampling Effects on SensorLLM)

為了讓大家更直觀地感受到這個問題的嚴重性，我們做了一個初步的實驗。

螢幕上的這張圖表展示了我們的發現。我們使用了目前最先進的SensorLLM模型，然後逐步降低輸入感測器數據的採樣率。大家可以看到，無論是準確率（Accuracy）還是F1分數，都出現了非常急劇的下降。

這個結果清楚地告訴我們：現有的先進模型，在面對低解析度、低品質的感測器數據時，其性能會變得非常脆弱。這也凸顯了我們研究要解決的核心挑戰。

## 傳統方法的局限性 (Traditional HAR: Limitations for Real-World Deployment)

在深度學習出現之前，傳統的HAR方法依賴手機或穿戴設備中的加速度計和陀螺儀。這些感測器的好處是輕便、省電，而且無處不在。

但它們有一個致命的限制：它們產生的數據是**粗糙的 (coarse-grained)**，精度遠遠比不上實驗室等級的設備。

問題在於，大多數早期的研究都是基於高品質的實驗室數據，這些方法很難準確區分動作之間的細微差異。因此，當我們想將這些模型部署到真實世界的消費級設備上時，效果往往大打折扣。這就形成了一個巨大的研究缺口。

## 深度學習的貢獻與限制 (Deep Learning Revolution: Progress and Limitations)

接著，深度學習的浪潮席捲而來，為HAR領域帶來了革命性的改變。像CNN和RNN這樣的模型，它們最厲害的地方在於能夠**自動從原始數據中提取特徵**，省去了過去繁瑣且困難的人工特徵工程。

這無疑是一個巨大的進步。然而，深度學習模型也有它的「阿基里斯之踵」。

大多數的深度學習模型，仍然是為**高品質、在實驗室環境下採集**的數據所設計的。在真實世界中，我們的設備採集到的數據充滿了雜訊，而且解析度很低。當這些模型面對這樣的數據時，它們的性能同樣會大打折扣。

所以，我們需要一種全新的方法，一種專門為真實世界、資源受限的部署場景所設計的方法。

## 新的機會：大型語言模型的出現 (New Frontiers: Transformers and Large Language Models)

幸運的是，近年來**大型語言模型 (LLM)** 和 **Transformer架構**的崛起，為我們解決這個問題提供了新的可能性。

像BERT和GPT這樣的模型，大家可能都很熟悉，它們在理解複雜的序列模式和上下文關係方面展現了驚人的能力。雖然它們最初是為自然語言處理設計的，但它們核心的**自注意力機制 (self-attention)**，在處理像感測器數據這樣的時間序列上，也顯示出了巨大的潛力。

這就為我們帶來了一個新的研究機會：我們是否可以利用LLM強大的序列建模能力，來提升在低品質數據下的HAR性能？

## 當前基於LLM的HAR方法的限制 (Current LLM-based HAR: Critical Limitations)

順著這個思路，學術界也開始出現一些基於LLM的HAR研究，並且取得了一些不錯的成果。

然而，現有的這些方法在**實際部署**時，面臨著幾個關鍵的障礙：
1. **計算要求高**：LLM模型通常非常龐大，需要大量的記憶體和計算資源，這在資源受限的穿戴設備上是不可行的。
2. **專注於實驗室數據**：它們的評估主要還是基於高品質的實驗室數據，並沒有真正解決我們前面提到的低頻率、低精度數據的問題。
3. **缺乏深入分析**：對於如何針對性地處理降採樣數據，比如數據對齊和特徵丟失的問題，還缺乏足夠的研究。

因此，目前仍然缺少一個專門為**粗糙數據**和**資源受限場景**設計的LLM解決方案。這正是我們工作的切入點。

## 我們的解決方案：一個新穎的兩階段流程 (Our Solution: Novel Two-Stage Pipeline)

為了解決上述所有挑戰，我們提出了一個創新的**兩階段處理流程**。

我們的核心思想非常直接：既然低頻率的數據品質不好，那麼在進行識別之前，我們先想辦法**提升它的品質**。

我們的方法結合了兩個領域的尖端技術：
- **第一階段 (數據增強)**：我們使用一個先進的時間序列處理模型**SAITS**，它的任務是從低頻率的訊號中，**恢復和重建**出高解析度的時間細節。
- **第二階段 (活動識別)**：接著，我們將增強後的高品質數據，送入一個高效的**SensorLLM**模型中進行最終的活動識別。

這種設計最大的優勢在於**解耦合**：我們將數據增強和活動識別這兩個任務分開，讓每個模型都能專注於自己最擅長的部份，從而在資源受限的情況下，實現最優的性能。

## 主要研究貢獻 (Key Research Contributions)

總結一下，我們這項研究的主要貢獻有以下四點：
1. 我們提出了一個**新穎的兩階段框架**，首次將最先進的時間序列插補技術(SAITS)與大型感測器語言模型(SensorLLM)結合，專門解決粗糙數據下的HAR問題。
2. 我們設計了一個**端到端的處理流程**，包含高效的數據轉換和微調策略，使模型在不犧牲準確率的前提下，能夠在設備上進行推理。
3. 我們進行了**全面的實驗評估**，系統性地分析了在不同降採樣等級下模型的性能極限。
4. 最重要的是，我們的框架為**在真實世界中部署**HAR應用提供了可能，解決了穿戴設備在延長電池壽命方面的關鍵需求。

## 報告大綱 (Presentation Outline)

接下來的報告中，我會依序介紹：
1.  **相關研究**：回顧這個領域的發展。
2.  **研究方法**：深入介紹我們兩階段流程的細節。
3.  **實驗**：展示我們的實驗設置、基準和結果。
4.  **結論**：總結我們的發現和未來工作。

## 相關研究回顧 (Related Work)

現在讓我回顧一下相關研究，看看學術界是如何逐步解決這些問題的。

### HAR領域的基礎研究 (Human Activity Recognition with Wearable Sensors)

HAR領域的發展其實有一個很清晰的脈絡。最早的時候，像Bulling等人的開創性工作[1]，為我們建立了這個領域的核心原則，他們強調了從多模態感測器數據中提取特徵的挑戰。接著，Lara和Labrador的綜述[2]對穿戴式感測器HAR進行了全面的梳理，為後續研究奠定了基礎。在深度學習興起之前，研究主要依賴手工設計的特徵，而Wang等人的工作[5]則清楚地展示了深度學習是如何透過自動學習特徵來徹底改變這個領域的。

### 深度學習在HAR中的應用 (Deep Learning Approaches for HAR)

深度學習的應用是從卷積神經網絡（CNNs）開始的。例如，Yang等人[6]開創性地將深度CNN應用於多通道時間序列數據，這使得模型能同時捕捉感測器通道之間的空間關係和活動序列內的時間依賴性。不久之後，Ignatov等人[8]和Ronao與Cho[18]的研究，則進一步展示了如何利用CNN在手機等移動設備上實現高效且即時的HAR系統。

### 增強時間建模能力 (Enhancing Temporal Modeling with RNNs)

為了更好地捕捉數據中的時間動態，研究人員引入了循環神經網絡（RNNs）。其中，Hammerla等人[7]的工作尤為重要，他們對深度模型、CNN和RNN進行了全面的比較，為不同的感測器配置和活動類型建立了最佳實踐。他們的重要發現是：不同的模型架構在捕捉時間模式上各有千秋，這指導我們需要根據具體應用來選擇最合適的架構。

### Transformer革命的到來 (The Transformer Revolution in HAR)

真正的轉折點，是伴隨著Transformer架構的出現。由Vaswani等人提出的自注意力機制[9]，因其捕捉長距離依賴關係和高效並行處理的能力，徹底改變了序列建模。很快，研究者們就成功地將Transformer應用於HAR，並在性能上超越了傳統的RNN方法。

### 專為HAR設計的Transformer (Specialized Transformers for HAR)

基於Transformer的成功，一系列專為HAR設計的架構應運而生。例如，Li等人提出的P2LHAP框架[19]，它將感測器數據流分割成“補丁”(patches)作為輸入，實現了在單一模型內同時處理活動識別、分割和預測等多項任務。Zhang等人則開發了MoPFormer[20]，它將信號分解為有語意涵義的「動作基元」，不僅提升了模型的跨數據集泛化能力，也增強了可解釋性。同時，像Zhao等人開發的ActionFormer[21]這樣的模型，也透過注意力機制來自動選擇資訊最豐富的感測器通道，進一步提升了性能。

### 大型語言模型在感測器數據中的應用 (Large Language Models for Sensor Data)

隨著自然語言處理領域的巨大成功，研究者們開始思考，是否能將大型語言模型（LLMs）的能力遷移到感測器數據上。BERT[10]和GPT-3[11]等模型的成功，展示了大規模預訓練模型在理解序列和上下文方面的強大潛力。這啟發了本領域的開創性工作，比如Li等人開發的SensorLLM[12]，它首次嘗試將LLM與運動感測器對齊，並成功展示了零樣本識別和跨模態推理的能力。

### 大規模感測器基礎模型 (Large-Scale Sensor Foundation Models)

在SensorLLM的基礎上，更大規模的感測器基礎模型開始出現。Zhang等人開發的SensorLM[15]就是一個里程碑，它處理了來自超過十萬名參與者的海量數據，並透過階層式標註生成，實現了與感測器系統的複雜自然語言互動。同時，Civitarese等人開發的ADL-LLM[22]則專注於智慧家庭場景，它將原始感測器事件轉換為文字描述，再交由LLM進行零樣本的日常生活活動識別。

### 使用LLM進行零樣本HAR (Zero-Shot HAR with LLMs)

零樣本識別是LLM應用於HAR的一個重要方向。Ji等人進行的HARGPT研究[13]極具代表性，他們直接將降採樣後的原始感測器序列輸入GPT-4，並透過精巧的角色扮演和思維鏈提示，在沒有任何額外訓練的情況下，達到了接近80%的準確率。然而，這種方法的挑戰在於需要龐大的模型、巨大的上下文窗口和複雜的提示工程，這限制了它在真實場景中的應用。

### 使用LLM進行高層次推理 (High-Level Reasoning with LLMs)

LLM的潛力遠不止於基礎的活動分類。近期的研究開始探索它們在感測器數據上進行複雜時空推理的能力。例如，Ouyang等人開發的LLMSense，利用LLM來進行如失智症診斷和居住者追踪等需要長期模式理解的複雜任務。而Mo等人提出的IoT-LM，則是一個大型多模態感測器語言模型，它能夠整合來自12種不同感測器的數據，實現全面的多感測器理解和互動式問答。

### 能源效率與資源限制 (Energy Efficiency and Resource Constraints)

在追求更高準確率的同時，能源效率始終是穿戴設備部署的關鍵挑戰。傳統的模型壓縮和量化方法雖然有效，但往往需要繁瑣的調校。因此，開發本身就具備高效率的架構成為一個更有前景的方向。Ruan等人設計的PAT模型[24]就是一個很好的例子，它是一個為穿戴設備時間序列數據預訓練的Transformer，專門在設計時就強調了計算效率和可解釋性。

### 數據採樣與降採樣策略 (Data Sampling and Downsampling Strategies)

這就引出了我們研究最關心的核心問題之一：數據採樣。感測器數據的解析度和識別性能之間存在著根本性的權衡。較高的採樣率能提供豐富的資訊，但會急劇增加計算和能源成本；而較低的採樣率雖然能延長電池壽命，卻會犧牲準確率。對於需要長時間連續監測的真實世界應用來說，這個問題至關重要。然而，過去絕大多數的HAR研究都假設有50到100赫茲的高頻數據，這在實際部署中是不切實際的，從而留下了一個巨大的研究空白。

### 時間序列插補與數據增強 (Time Series Imputation and Data Enhancement)

為了解決低解析度數據的問題，時間序列插補技術提供了一個可能的解決方案。這個領域本身也在不斷進步。早期的統計或基於RNN的方法在面對大量數據缺失時效果有限。Du等人開發的SAITS[14]是一個重要的突破，它使用純自注意力機制來同時建模時間和跨通道的相關性，用更少的參數在多個基準上超越了之前的方法。最近，更有研究如Islam等人[16]將自注意力與擴散模型結合，進一步提升了在部分數據完全丟失場景下的插補性能。

### 研究空白與動機 (Research Gaps and Motivation)

通過這個全面的文獻回顧，我們發現了幾個重要的研究空白，這也正是我們研究的動機所在：
1.  先進的插補模型（如SAITS）與下游的LLM識別器之間的**協同作用**還未被探索。
2.  LLM與感測器數據的整合主要集中在**高品質數據**上，它們在降採樣數據上的有效性仍然未知。
3.  目前缺乏對低解析度數據的**注意力模式和轉換策略**的深入分析。
4.  對於感測器解析度降低對識別性能的**根本極限**，我們還缺乏足夠的了解。

### 我們對領域的貢獻 (Our Contribution to the Field)

正是基於這些研究空白，我們的工作做出了以下貢獻：
- 我們首次系統性地研究了**SAITS-LLM的協同作用**，專門用於處理粗糙的HAR數據。
- 我們提出了專為**降採樣感測器數據優化**的新型轉換策略。
- 我們進行了全面的實驗，以確定在不同**降採樣水平下**的性能極限。
- 最終，我們的工作在HAR的理論研究與真實世界穿戴系統的**實際部署**之間架起了一座橋樑。

## 方法論 (Methodology)

### 變量定義 (Variable Definitions)

在我們的方法中，我們使用以下變量來描述我們的模型和數據處理過程：
- **$\mathbf{X}$**：長度為 $T$ 的多變量時間序列，具有 $d$ 個感測器通道。
- **$\mathbf{M}$**：二進制觀察掩碼，其中 $M_{t,f}=1$ 表示觀察到的值 $X_{t,f}$。
- **$\mathbf{H}^{(1)}$**：第一個 DMSA 區塊後的隱藏表示。
- **$\mathbf{\tilde X}^{(1)}$**：第一個 DMSA 區塊後缺失值的初始估計。
- **$\mathbf{\tilde X}^{(2)}$**：第二個 DMSA 區塊後缺失值的精細估計。
- **$\mathbf{\tilde X}^{(3)}$**：第三個 DMSA 區塊後的最終插補信號。
- **$\boldsymbol{\eta}$**：用於在第三個 DMSA 區塊中融合估計的可學習門。
- **$\hat{\mathbf{X}}$**：轉發到 HAR 模型的最終插補時間序列。
- **$\mathbf{E}_{\text{input}, i}$**：LLM 的文本提示和感測器數據的組合嵌入。
- **$\mathbf{h}_{\text{last}, i}$**：LLM 的最終隱藏狀態。
- **$\hat{\mathbf{y}}_i$**：活動類別的預測概率分佈。
- **$\mathcal{L}_{\text{SAITS}}$**：SAITS 的損失函數，結合重建和插補損失。
- **$\mathcal{L}_{\text{HAR}}$**：HAR 任務的加權交叉熵損失。

### 兩階段流程回顧 (The Two-Stage Pipeline Revisited)

我們的方法論基於一個創新的兩階段流程：
1. **階段 1：基於 SAITS 的時間序列插補**
   - 使用最先進的自注意力機制增強低解析度的感測器數據。
2. **階段 2：SensorLLM 訓練**
   - 在增強的高解析度數據上訓練高效的 HAR 模型。

### SAITS 插補 - 研究動機 (Stage 1: SAITS Imputation - Research Motivation)

為什麼選擇 SAITS 用於 HAR？
- **卓越的時間重建能力：** 從粗略或部分觀察的感測器數據中恢復細粒度的時間信息。
- **計算效率：** 純自注意力機制使得訓練收斂更快，內存佔用更低，插補準確性更高。
- **經驗上的優越性：** 比 BRITS 低 12-38% 的 MAE，比 NRTSI 低 7-39% 的 MSE。
- **緊湊的架構：** 僅需標準 Transformer 模型 15-30% 的參數。

### 研究新穎性與定位 (Research Novelty and Positioning)

- **研究空白：** 先前的工作通常將插補和感測器-語言建模分開研究。
- **我們的關鍵創新：** 在統一的流程中將 SAITS 與 SensorLLM 結合。
- **基本見解：** 高質量的重建是可靠的 LLM 基於 HAR 的先決條件，特別是在激進的降採樣下。
- **經驗驗證：** 這種簡單但未被探索的耦合被證明是非常有效的，構成了我們框架的核心新穎性。
- **實際影響：** 使資源受限的穿戴設備上能夠實現穩健的 HAR 性能。

### SAITS 架構 (Stage 1: SAITS Architecture)

- **輸入：** 含有缺失值的多變量時間序列（我們的低解析度數據）。
- **掩碼：** 二進制掩碼指示哪些數據點是觀察到的，哪些是缺失的。
- **自注意力區塊：** 多頭自注意力的堆疊層，跨所有時間步和特徵建模依賴性。
- **插補：** 模型通過使用學習的注意力權重聚合觀察到的條目信息來預測缺失值。

### SAITS 數學公式 (Stage 1: SAITS Mathematical Formulation)

- **輸入變量：**
  - **$\mathbf{X}$**：長度為 $T$ 的多變量時間序列，具有 $d$ 個感測器通道。
  - **$\mathbf{M}$**：二進制觀察掩碼，其中 $M_{t,f}=1$ 表示觀察到的值 $X_{t,f}$。
- **過程：**
  - SAITS 使用三個連續的 **雙掩碼自注意力 (DMSA)** 區塊。
    1. **區塊 1（粗略估計）：** 生成缺失值的初始估計。
       $$
       \mathbf{H}^{(1)} = \operatorname{DMSA}_1\bigl(\phi([\mathbf{X}, \mathbf{M}])\bigr), \qquad \mathbf{\tilde{X}}^{(1)} = \psi\bigl(\mathbf{H}^{(1)}\bigr)
       $$
       - **$\mathbf{H}^{(1)}$**：第一個 DMSA 區塊後的隱藏表示。
       - **$\mathbf{\tilde X}^{(1)}$**：缺失值的初始估計。
    2. **區塊 2（精細化）：** 精細化初始估計以生成 $\mathbf{\tilde X}^{(2)}$。
       - **$\mathbf{\tilde X}^{(2)}$**：缺失值的精細估計。
    3. **區塊 3（門控融合）：** 使用可學習門 $\boldsymbol{\eta}\in[0,1]^{T\times d}$ 融合兩個估計。
       $$
       \mathbf{\tilde{X}}^{(3)} = (1 - \boldsymbol{\eta}) \odot \mathbf{\tilde{X}}^{(2)} + \boldsymbol{\eta} \odot \mathbf{\tilde{X}}^{(1)}
       $$
       - **$\boldsymbol{\eta}$**：用於融合估計的可學習門。
       - **$\mathbf{\tilde X}^{(3)}$**：最終插補信號。
- **輸出：**
  - **$\hat{\mathbf{X}}$**：轉發到 HAR 模型的最終插補時間序列。

### SAITS 訓練目標 (Stage 1: SAITS Training Objective)

- **目標函數：**
  - SAITS 通過聯合最小化兩個損失進行訓練：
    1. **觀察重建任務 (ORT)：** 觀察值的重建損失。
    2. **掩碼插補任務 (MIT)：** 人工掩碼值（保留集）的插補損失。
- **損失函數：**
  $$
  \mathcal{L}_{\text{SAITS}} = \lambda_{\text{rec}} \operatorname{MAE}(\mathbf{M} \odot \mathbf{\tilde{X}}^{(3)}, \mathbf{M} \odot \mathbf{X}) + \lambda_{\text{imp}} \operatorname{MAE}(\mathbf{M}^{\mathrm{h}} \odot \mathbf{\tilde{X}}^{(3)}, \mathbf{M}^{\mathrm{h}} \odot \mathbf{X})
  $$
  - **$\mathcal{L}_{\text{SAITS}}$**：SAITS 的損失函數，結合重建和插補損失。

### SensorLLM 訓練 (Stage 2: SensorLLM Training for HAR)

- 這一階段利用來自階段 1 的增強、高解析度數據來訓練一個強大、上下文感知的 HAR 分類器。
- **核心組件：**
    1. **預訓練的時間序列嵌入器 (Chronos)**
    2. **預訓練的大型語言模型 (LLaMA-3)**
    3. 輕量級、可訓練的**對齊模塊 (MLP)**

### SensorLLM 框架 (Stage 2: SensorLLM Framework)

- 時間序列嵌入器 (Chronos) 從感測器數據中提取豐富的時間特徵。
- LLM (LLaMA-3) 作為推理骨幹。
- 對齊模塊作為橋樑，將感測器嵌入投影到 LLM 的表示空間。
- **效率關鍵：** 大型時間序列嵌入器和 LLM 是**凍結的**。只有小的對齊模塊和最終分類器頭被訓練。

### HAR 預測和目標 (Stage 2: HAR Prediction and Objective)

- **輸入表示：**
  - 對於給定的感測器樣本 $\mathbf{X}_i$ 和文本提示 $Q_i$（例如，“這是什麼活動？”），LLM 輸入通過連接文本提示和投影感測器數據的嵌入來構建：
    $$
    \mathbf{E}_{\text{input}, i} = [\mathbf{E}_{\text{prompt}, i}, \mathbf{E}_{\text{aligned}, i}] = [\text{Embed}(Q_i), \Theta_{\text{Align}}(\Phi_{\text{TS}}(\mathbf{X}_i))]
    $$
    - **$\mathbf{E}_{\text{input}, i}$**：LLM 的文本提示和感測器數據的組合嵌入。
- **預測：**
  - LLM 的最終隱藏狀態被傳遞到一個可訓練的線性分類器，輸出活動類別的概率分佈。
    $$
    \hat{\mathbf{y}}_i = \text{Softmax}(\Theta_{\text{Clf}}(\mathbf{h}_{\text{last}, i}))
    $$
    - **$\hat{\mathbf{y}}_i$**：活動類別的預測概率分佈。
- **目標函數：**
  - 我們使用**加權交叉熵損失**來對抗 HAR 數據集中的類別不平衡問題。
    $$
    \mathcal{L}_{\text{HAR}}(\hat{\mathbf{y}}_i, \mathbf{y}_i) = - \sum_{k=1}^{K} w_k y_{ik} \log(\hat{y}_{ik})
    $$
    - **$\mathcal{L}_{\text{HAR}}$**：HAR 任務的加權交叉熵損失。

### 階段 1 到階段 2 的整合 (Integration: Stage 1 to Stage 2)

- 階段 1 的輸出（增強的高解析度感測器數據）作為階段 2 的直接輸入。
- SAITS 從粗略的輸入中重建時間豐富的序列。
- 這種整合確保下游 HAR 模型接收到恢復了時間細節的數據，這對於準確識別至關重要。
- 插補不僅僅是預處理；它是穩健的 LLM 基於 HAR 的**關鍵促成因素**。

## 初步觀察 (Preliminary)

在深入解決方案之前，讓我分享一些有趣的觀察結果。

我們發現，隨著感測器數據採樣率的降低，SensorLLM基礎模型的F1分數會顯著下降。這個效應對不同類型的活動影響程度不同。

對於靜態活動如坐着，雖然也有性能下降，但相對還能接受。

對於睡眠這種長時間的靜態活動，在低採樣率下還能保持相對較好的識別性能。

但是對於動態活動如騎自行車，採樣率降低的影響就非常明顯了。這些結果證實了我們的假設：動態活動需要更高的時間解析度來準確識別。

## 我們的解決方案 (Our Solution)

基於這些觀察，我們提出了一個兩階段的解決方案。

核心思路是：既然低解析度數據缺乏細節，那我們就想辦法把細節"補回來"。

第一階段使用SAITS進行時間序列插補，將低解析度數據轉換為高解析度數據。

第二階段使用SensorLLM在增強後的數據上進行活動識別。

這種設計的優勢在於：我們將數據增強和識別分開處理，每個階段都可以專注於自己最擅長的任務。

## 第一階段：SAITS插補 (Stage 1: SAITS Imputation)

### 為什麼選擇SAITS？ (Why SAITS for HAR?)

選擇SAITS是經過深思熟慮的。首先，SAITS具有優秀的時間重建能力，能夠從粗糙的數據中恢復細緻的時間資訊。

其次，它的計算效率很高。純自注意力機制避免了RNN的序列依賴問題，訓練更快，記憶體佔用更少。

最重要的是，實驗證明它確實有效。在多個基準數據集上，SAITS的表現都超過了傳統方法。

### SAITS的工作原理 (SAITS Architecture)

SAITS的核心是三個連續的雙掩碼自注意力塊，每個塊都有特定的功能：

第一個塊進行粗糙估計，學習全局的時間模式。

第二個塊進行精細化，捕捉更細緻的時間依賴關係。

第三個塊進行智能融合，使用可學習的門控機制來組合前兩個塊的結果。

這種漸進式的設計確保了插補的品質和穩定性。

### 訓練策略 (SAITS Training Objective)

SAITS的訓練策略也很巧妙。它同時優化兩個任務：

一個是重建已觀察到的值，確保模型學習到正確的時間關係。

另一個是預測人工掩碼的值，測試模型的插補能力。

這種雙任務設計確保了模型既能保持一致性，又能準確填補缺失信息。

## 第二階段：SensorLLM訓練 (Stage 2: SensorLLM Training)

### 架構設計 (SensorLLM Framework)

第二階段的架構包含三個核心組件：

首先是Chronos時間序列編碼器，它專門為時間序列設計，能夠提取豐富的時間特徵。

其次是LLaMA-3大型語言模型，它提供強大的序列建模和推理能力。

最後是一個輕量級的對齊模組，將時間序列特徵投影到語言模型的空間中。

### 效率考量 (Efficiency Considerations)

這個設計的關鍵在於效率。我們只訓練對齊模組和分類頭，而保持大型的預訓練模型凍結。這大大減少了計算成本，使得在資源受限的設備上部署成為可能。

### 多模態融合 (Multimodal Fusion)

我們將感測器數據和文本提示一起送入LLaMA-3，讓它進行多模態推理。這種設計讓模型能夠理解任務上下文，提高識別準確性。

## 實驗設計與結果 (Experiments)

### 實驗設置 (Experimental Setup)

我們使用Capture-24數據集進行實驗，這是HAR領域的標準基準。數據集包含了不同年齡、性別參與者的多樣化活動數據。

我們比較了幾種方法：直接使用SensorLLM、使用LSTM增強的SensorLLM，以及我們的SAITS增強方法。

### 結果分析 (Results Analysis)

結果非常令人鼓舞。我們的SAITS增強方法在多個指標上都表現最好，特別是在具有挑戰性的動態活動上。

比如騎自行車、車輛、步行這些活動，我們的方法取得了最高的F1分數。這說明SAITS確實能夠重建這些動態活動所需的關鍵細節。

相比之下，直接使用低解析度數據的方法在這些活動上表現很差，說明數據增強是必要的。

## 消融研究 (Ablation Study)

我們還進行了消融研究，測試了不同降採樣程度對性能的影響。

結果確認了我們的假設：隨著降採樣程度的增加，所有指標都會下降。但是，使用我們的方法，即使在很低的採樣率下，仍然能夠保持相對較好的性能。

這個結果非常重要，因為它證明了我們的方法在真實世界的資源受限環境中確實有效。

## 結論與貢獻 (Conclusion)

總結一下，我們的主要貢獻包括：

1. 提出了一個新穎的兩階段框架，有效結合了時間序列插補和大型語言模型的優勢
2. 首次將SAITS應用於HAR的降採樣問題，開創了新的研究方向
3. 通過全面的實驗驗證了方法的有效性
4. 為資源受限的穿戴設備部署提供了實用的解決方案

## 未來展望 (Future Work)

未來的工作可以從幾個方向展開：

首先是擴展到更多類型的感測器，不僅限於加速度計和陀螺儀。

其次是優化推理效率，使得模型能夠在更受限的設備上運行。

最後是探索知識蒸餾等技術，進一步壓縮模型大小而不影響性能。

## 結語 (Closing Remarks)

我們的研究解決了一個非常實際的問題：如何在節能的同時保持高精度的活動識別。這項工作不僅有理論意義，更有實際應用價值。

想想看，如果這項技術能夠應用到你的智慧手錶上，你就能享受更長的電池壽命，同時還能獲得更準確的活動監測。這就是我們研究的最終目標。

謝謝大家的聆聽！歡迎提問和討論。
